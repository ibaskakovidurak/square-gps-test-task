import{r as g,o as c,d as x,c as k,e as C,F as V,u as I,f as R,w as m,g as r,a as T,t as O,h as S,n as D,b as A,i as b,_ as W,j as q,k as P,l as U,m as G,p as w,q as H,s as J,v as K}from"./index-BjQTcqHJ.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={__name:"SkeletonMarkerList",props:["loading"],setup(n){return(i,M)=>{const e=g("v-skeleton-loader");return c(),x(V,null,[n.loading?(c(),k(e,{key:0,class:"mx-auto mt-6",elevation:"12",type:"article, button"})):C("",!0),n.loading?(c(),k(e,{key:1,class:"mx-auto mt-6",elevation:"12",type:"article, button"})):C("",!0)],64)}}},Y={class:"text-h4 text-md-h2 text-xl-h1 text-truncate"},Z={key:0,class:"mt-6"},j={__name:"MarkerList",props:{loading:Boolean,markers:Array},emits:["watchOnMap"],setup(n,{emit:i}){const M=I(),e=R(()=>M.getters.getLocale),h=i,v=a=>{h("watchOnMap",a)};return(a,p)=>{const y=g("v-col"),t=g("v-btn"),$=g("v-card"),l=g("v-row");return c(),k(l,{dense:"",class:"overflow-auto row-max-height"},{default:m(()=>[r(y,{cols:"12",class:"mb-6"},{default:m(()=>[T("h1",Y,O(a.$locale("markers",e.value)),1),!n.markers.length&&!n.loading?(c(),x("p",Z,O(a.$locale("markersEmpty",e.value)),1)):C("",!0),r(X,{loading:n.loading},null,8,["loading"])]),_:1}),(c(!0),x(V,null,S(n.markers,f=>(c(),k(y,{key:f,cols:"12",class:D(f.active?"bg-blue":"")},{default:m(()=>[r($,{title:`${a.$locale("buttons.marker",e.value)} #${f.id}`,text:`${a.$locale("buttons.address",e.value)}: ${f.address}`},{actions:m(()=>[r(t,{color:"primary",variant:"text",onClick:L=>v(f)},{default:m(()=>[A(O(a.$locale("buttons.watchOnMap",e.value)),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","text"])]),_:2},1032,["class"]))),128))]),_:1})}}},ee={__name:"Map",props:{editing:Boolean,created:Boolean,markers:Array,mapCenter:Array},emits:["addedMarker","watchOnMap","creating","created"],setup(n,{emit:i}){const M=I(),e=i,h=n,v={default:"red",active:"#006efc"},a=async t=>{await M.dispatch("addMarker",{coords:[t[0],t[1]]})},p=(t,$)=>{if(h.editing===!0)return async(l,f)=>{(l==null?void 0:l.type)!=="marker"&&(e("creating"),await a(f.coordinates),e("addedMarker",!0),e("creating"),e("created"))}},y=t=>{e("watchOnMap",t)};return(t,$)=>(c(),k(b(G),{settings:{location:{center:n.mapCenter,zoom:15}},height:"81vh"},{default:m(()=>[r(b(W),{settings:{theme:"dark"}}),r(b(q)),(c(!0),x(V,null,S(n.markers,l=>(c(),k(b(P),{settings:{coordinates:l.coordinates,color:l.active?v.active:v.default,onClick:()=>y(l)}},null,8,["settings"]))),256)),r(b(U),{settings:{onClick:p("dom","click")}},null,8,["settings"])]),_:1},8,["settings"]))}},z={__name:"Tooltip",props:["color","text"],setup(n){const i=w(!0);return(M,e)=>{const h=g("v-btn"),v=g("v-snackbar");return c(),k(v,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),color:n.color,elevation:"24",timeout:3e3},{actions:m(()=>[r(h,{color:"white",variant:"text",onClick:e[0]||(e[0]=a=>i.value=!1)},{default:m(()=>e[2]||(e[2]=[A(" Ã— ")])),_:1})]),default:m(()=>[A(O(n.text)+" ",1)]),_:1},8,["modelValue","color"])}}},te={__name:"MapView",setup(n){const i=H(),M=w(i.currentRoute),e=I(),h=R(()=>e.getters.getLocale),v=w(!1),a=w(!1),p=w(!1),y=w(!0),t=w([]),$=["20.6585188335062","44.87238218431069"],l=w($),f=async u=>{u.name==="map"&&(t.value.forEach(o=>o.active=!1),l.value=$,await e.dispatch("addMarkers",{data:t.value}))},L=u=>{var s;const o=(s=M.value.params)==null?void 0:s.id;!u.find(d=>d.id===o)&&o&&i.push({name:"notFound"})},E=async u=>{const o=await e.dispatch("getMarkers");t.value=o.sort((s,d)=>parseInt(d.id)-parseInt(s.id)),u&&(a.value=v.value=p.value=!1),L(t.value);const _=t.value.find(s=>s.active===!0);if(_){const[s,d]=_.coordinates;l.value=[s,d]}y.value=!1},F=async u=>{const[o,_]=u.coordinates,s=t.value.find(d=>{const[B,N]=d.coordinates;return o===B&&_===N});if(s){const[d,B]=s.coordinates;t.value.forEach(N=>N.active=!1),s.active=!0,l.value=[d,B],await e.dispatch("addMarkers",{data:t.value}),await i.push({name:"mapItem",params:{id:s.id}})}};return J(async()=>{await E()}),K(M,async u=>{await f(u)},{deep:!0}),(u,o)=>{const _=g("v-col"),s=g("v-btn");return c(),x(V,null,[r(_,{cols:"12",lg:"4",md:"4"},{default:m(()=>[r(j,{markers:t.value,loading:y.value,onWatchOnMap:F},null,8,["markers","loading"])]),_:1}),r(_,{cols:"12",lg:"8",md:"8"},{default:m(()=>[r(ee,{class:"bg-white",markers:t.value,"map-center":l.value,editing:p.value,creating:a.value,onCreated:o[0]||(o[0]=d=>a.value=!0),onCreating:o[1]||(o[1]=d=>v.value=!0),onAddedMarker:E,onWatchOnMap:F},null,8,["markers","map-center","editing","creating"]),r(_,{cols:"12",class:"d-flex justify-end position-relative"},{default:m(()=>[r(s,{icon:"mdi-plus",size:"large","base-color":p.value?"orange":"blue",class:D(["position-absolute btn-create",{"--editing":p.value}]),onClick:o[2]||(o[2]=d=>p.value=!p.value)},null,8,["base-color","class"])]),_:1})]),_:1}),a.value?(c(),k(z,{key:0,color:"green",text:u.$locale("notification.success",h.value)},null,8,["text"])):C("",!0),v.value?(c(),k(z,{key:1,color:"primary",text:u.$locale("notification.creating",h.value)},null,8,["text"])):C("",!0)],64)}}},oe=Q(te,[["__scopeId","data-v-6d732218"]]);export{oe as default};
